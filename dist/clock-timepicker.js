export var TimeFormat;!function(t){t["HH:mm"]="HH:mm",t["H:mm"]="H:mm",t["hh:mm"]="hh:mm",t["h:mm"]="h:mm",t["HH:mm:ss"]="HH:mm:ss",t["hh:mm:ss"]="hh:mm:ss",t["H:mm:ss"]="H:mm:ss",t["h:mm:ss"]="h:mm:ss",t["mm:ss"]="mm:ss",t["m:ss"]="m:ss",t.HH="HH",t.H="H",t.hh="hh",t.h="h",t.mm="mm",t.m="m",t.ss="ss",t.s="s"}(TimeFormat||(TimeFormat={}));export var TimePart;!function(t){t.Hour="Hour",t.Minute="Minute",t.Second="Second"}(TimePart||(TimePart={}));export class Time{get hour(){return Math.floor(Math.abs(this.totalSeconds)/3600)}get minute(){return Math.floor((Math.abs(this.totalSeconds)-3600*this.hour)/60)}get second(){return Math.abs(this.totalSeconds)-3600*this.hour-60*this.minute}static get Zero(){return new Time}static parse(t,e){if(!t)return;const i=t.toLowerCase().match(/^([+|-])?([0-9]+)([^0-9]+([0-9]+)([^0-9]+([0-9]+))?)?( *(am|pm))?$/i);if(i)switch(e){case"HH:mm":case"hh:mm":case"H:mm":case"h:mm":case"HH:mm:ss":case"hh:mm:ss":case"H:mm:ss":case"h:mm:ss":case"HH":case"hh":case"H":case"h":return new Time(Time.getHour(i[2],i[8]),Time.getMinute(i[4]),Time.getSecond(i[6]),"-"==i[1]);case"mm:ss":case"m:ss":return i[6]&&new Time(Time.getHour(i[2],i[8]),Time.getMinute(i[4]),Time.getSecond(i[6]),"-"==i[1]),new Time(0,this.getMinute(i[2]),this.getSecond(i[4]),"-"==i[1]);case"mm":case"m":return i[4]?new Time(Time.getHour(i[2],i[8]),this.getMinute(i[4]),Time.getSecond(i[6]),"-"==i[1]):new Time(0,this.getMinute(i[2]),0,"-"==i[1]);case"ss":case"s":return i[6]?new Time(Time.getHour(i[2],i[8]),Time.getMinute(i[4]),Time.getSecond(i[6]),"-"==i[1]):i[4]?new Time(0,this.getMinute(i[2]),Time.getSecond(i[4]),"-"==i[1]):new Time(0,0,this.getSecond(i[2]))}else console.error("[clock-timepicker] Cannot parse time: "+t+". Invalid time format!")}static getHour(t,e=void 0){if(!t)return 0;let i=parseInt(t);return e&&("am"==e&&12==i&&(i=0),"pm"==e&&i>=0&&i<12&&(i+=12)),i}static getMinute(t){if(!t)return 0;const e=parseInt(t);return e>=60?(console.warn("[clock-timepicker] Minute cannot be greather than 59, but found: "+t+"!"),0):e}static getSecond(t){if(!t)return 0;const e=parseInt(t);return e>=60?(console.warn("[clock-timepicker] Second cannot be greather than 59, but found: "+t+"!"),0):e}constructor(t=0,e=0,i=0,s=!1){t=Math.abs(t),e=Math.abs(e),i=Math.abs(i),this.isNegative=s,this.totalSeconds=(s?-1:1)*(3600*t+60*e+i)}getTimePart(t){return t==TimePart.Hour?this.hour:t==TimePart.Minute?this.minute:t==TimePart.Second?this.second:0}isZero(){return 0==this.totalSeconds}equals(t){return this.totalSeconds==t.totalSeconds&&this.isNegative==t.isNegative}isLessThan(t){return this.totalSeconds<t.totalSeconds}isGreaterThan(t){return this.totalSeconds>t.totalSeconds}add(t){const e=this.totalSeconds+t.totalSeconds;return new Time(0,0,e,e<0)}subtract(t){const e=this.totalSeconds-t.totalSeconds;return new Time(0,0,e,e<0)}clone(){return new Time(0,0,this.totalSeconds,this.isNegative)}}export class ClockTimepicker extends HTMLElement{constructor(){super(...arguments),this._animationDuration=300,this._autosize=!1,this._cancelText="Cancel",this._disabled=!1,this._format=TimeFormat["HH:mm"],this._maximum=new Time(23,59,59),this._minimum=Time.Zero,this._okText="OK",this._precision=new Time(0,0,1),this._required=!1,this._separator=":",this._usePlusSign=!1,this._value=void 0,this._previousValue=void 0,this._vibrate="vibrate"in navigator,this._input=void 0,this._inputObserver=void 0,this._scrollContainer=void 0,this._caretColorBefore=void 0,this._shadowRoot=void 0,this._backgroundLayer=void 0,this._popup=void 0,this._header=void 0,this._canvasHolder=void 0,this._footer=void 0,this._canvases=[],this._activeTimePart=void 0,this._isSet=!1,this._enteredDigits=void 0,this.failedValueBecauseOfMinimum=void 0,this.failedValueBecauseOfMaximum=void 0,this.orientationChangeListener=()=>this.positionPopup(),this.resizeListener=()=>this.positionPopup(),this.scrollListener=()=>this.positionPopup(),this.contextMenuListener=t=>t.preventDefault(),this.focusListener=()=>{var t;this._input&&(this.disabled||(this.selectTimePart(null!==(t=this._activeTimePart)&&void 0!==t?t:this.getAvailableTimeParts()[0]),this.showPopup(),this.fireEvent("focus")))},this.inputBlurListener=()=>{setTimeout(()=>{this.hidePopup();const t=window.getSelection();(null==t?void 0:t.anchorNode)==this&&t.empty(),this.fireEvent("blur")})},this.inputMouseDownListener=t=>{if(t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation(),this._disabled)return;const e=this.getClickedTimePart(t),i=this.getAvailableTimeParts();"start"==e?this.selectTimePart(i[0]):"end"==e?this.selectTimePart(i[i.length-1]):this.selectTimePart(e)},this.inputKeyDownListener=t=>{if(this._input&&this._value&&this._activeTimePart&&!t.key.match(/^[0-9]$/)){if("Tab"==t.key){const t=this.getAvailableTimeParts();if(t.findIndex(t=>t==this._activeTimePart)==t.length-1)return}switch(t.preventDefault(),t.key){case"Tab":this.selectNextTimePart();break;case"Enter":this.ok();break;case"Escape":this.cancel();break;case"+":this._value.isNegative&&this.negateTime();break;case"-":this._value.isNegative||this.negateTime();break;case":":case".":case this.separator:this.selectNextTimePart(!1);break;case"ArrowUp":if(this._activeTimePart==TimePart.Hour){const t=Math.ceil(this._precision.totalSeconds/3600),e=this._value.totalSeconds+3600*t;this.setTime(new Time(0,0,e,e<0||0==e&&this._value.isNegative))}else if(this._activeTimePart==TimePart.Minute){const t=Math.ceil(this._precision.totalSeconds/60),e=this._value.totalSeconds+60*t;this.setTime(new Time(0,0,e,e<0||0==e&&this._value.isNegative))}else{const t=this._value.totalSeconds+this._precision.totalSeconds;this.setTime(new Time(0,0,t,t<0||0==t&&this._value.isNegative))}break;case"ArrowDown":if(this._activeTimePart==TimePart.Hour){const t=Math.ceil(this._precision.totalSeconds/3600),e=this._value.totalSeconds-3600*t;this.setTime(new Time(0,0,e,e<0||0==e&&this._value.isNegative))}else if(this._activeTimePart==TimePart.Minute){const t=Math.ceil(this._precision.totalSeconds/60),e=this._value.totalSeconds-60*t;this.setTime(new Time(0,0,e,e<0||0==e&&this._value.isNegative))}else{const t=this._value.totalSeconds-this._precision.totalSeconds;this.setTime(new Time(0,0,t,t<0||0==t&&this._value.isNegative))}break;case"ArrowLeft":this.selectPreviousTimePart();break;case"ArrowRight":this.selectNextTimePart(!1);break;case"Backspace":case"Delete":this._enteredDigits=void 0;0==this._value.getTimePart(this._activeTimePart)?this.required||0!=this._value.totalSeconds||this._activeTimePart!=this.getAvailableTimeParts()[0]?this.selectPreviousTimePart():(this._input.value="",this.autosizeInput(),this._isSet=!1,this._input.blur()):this.setTimePart(this._activeTimePart,0)}}},this.inputKeyUpListener=t=>{if(t.preventDefault(),!this._activeTimePart||!this._value||!t.key.match(/^[0-9]$/))return;const e=(null!=this._enteredDigits?this._enteredDigits:"")+t.key,i=new Time(this._activeTimePart==TimePart.Hour?parseInt(e):this._value.hour,this._activeTimePart==TimePart.Minute?parseInt(e):this._value.minute,this._activeTimePart==TimePart.Second?parseInt(e):this._value.second);if(i.isGreaterThan(this._maximum)||i.isLessThan(this._minimum))this._enteredDigits=void 0;else if(this._enteredDigits=e,this.setTimePart(this._activeTimePart,parseInt(this._enteredDigits)),this._activeTimePart!=TimePart.Hour&&(parseInt(this._enteredDigits)>5||this._enteredDigits.length>=2))this.selectNextTimePart();else{const t=this._enteredDigits+"0",e=new Time(this._activeTimePart==TimePart.Hour?parseInt(t):this._value.hour,this._activeTimePart==TimePart.Minute?parseInt(t):this._value.minute,this._activeTimePart==TimePart.Second?parseInt(t):this._value.second,this._value.isNegative);(e.isGreaterThan(this._maximum)||e.isLessThan(this._minimum))&&this.selectNextTimePart()}}}get animationDuration(){return this._animationDuration}set animationDuration(t){if(t){if("string"==typeof t){if(!t.match(/^[0-9]+$/))return void console.error("[clock-timepicker] Invalid animationDuration specified: "+t+"! Must be a number between 0 and 1000ms. Default is: 300ms");t=parseInt(t)}}else t=300;t<0||t>1e3?console.error("[clock-timepicker] Invalid animationDuration specified: "+t+"! Must be a number between 0 and 1000ms. Default is: 300ms"):this._animationDuration=t}get autosize(){return this._autosize}set autosize(t){null==t?t=!1:"string"==typeof t&&(t=!t.match(/^false$/i)),this._autosize=t}get disabled(){return this._disabled}set disabled(t){null==t?t=!1:"string"==typeof t&&(t=!t.match(/^false$/i)),this._disabled=t,this._input&&(this._disabled?(document.activeElement==this._input&&this.cancel(),this._input.style.cursor="default"):this._input.style.cursor="text")}get format(){return this._format}set format(t){if(t)if("string"==typeof t){if(!TimeFormat[t])return void console.error("[clock-timepicker] Invalid format specified: "+t+"!");this._format=TimeFormat[t]}else this._format=t;else this.format=TimeFormat["HH:mm"]}get maximum(){return this._maximum}set maximum(t){t&&("string"!=typeof t||(t=Time.parse(t,this.format))?t.isLessThan(this._minimum)?console.error("[clock-timepicker] Maximum cannot be less than minimum!"):(this._maximum=t,this.failedValueBecauseOfMaximum&&(this.value=this.failedValueBecauseOfMaximum,this.failedValueBecauseOfMaximum=void 0)):console.error("[clock-timepicker] Invalid maximum specified: "+t+"!"))}get minimum(){return this._minimum}set minimum(t){t&&("string"!=typeof t||(t=Time.parse(t,this.format))?t.isGreaterThan(this._maximum)?console.error("[clock-timepicker] Minimum cannot be greater than maximum!"):(this._minimum=t,this.failedValueBecauseOfMinimum&&(this.value=this.failedValueBecauseOfMinimum,this.failedValueBecauseOfMinimum=void 0)):console.error("[clock-timepicker] Invalid minimum specified: "+t+"!"))}get precision(){return this._precision}set precision(t){if(null==t)this._precision=new Time(0,0,1);else if("number"==typeof t)t<1?console.error("[clock-timepicker] Precision must be positive and greater than zero: "+t+"!"):this._precision=new Time(0,t,0);else if("string"==typeof t){const e=Time.parse(t,this._format);null==e?console.error("[clock-timepicker] Invalid precision specified: "+t+"!"):(null==e?void 0:e.isLessThan(new Time(0,0,1)))?console.error("[clock-timepicker] Precision must be positive and greater than zero: "+t+"!"):this._precision=e}else t.isLessThan(new Time(0,0,1))?console.error("[clock-timepicker] Precision must be positive and greater than zero: "+t+"!"):this._precision=t}get required(){return this._required}set required(t){null==t?t=!1:"string"==typeof t&&(t=!t.match(/^false$/i)),this._required=t}get separator(){return this._separator}set separator(t){if(t){if(t.match(/[0-9]/))return void console.error("[clock-timepicker] Invalid separator specified: "+t+"! Separator cannot consist of a number.")}else t=":";this._separator=t}get usePlusSign(){return this._usePlusSign}set usePlusSign(t){null==t?t=!1:"string"==typeof t&&(t=!t.match(/^false$/i)),this._usePlusSign=t}get value(){if(this._value)return this.formatTime().replace(/^\+/,"")}get time(){return this._value}set value(t){t?"string"==typeof t&&(t=Time.parse(t,this.format)):t=void 0,null==t?this._value=this.required?this.minimum:void 0:(t.isLessThan(this.minimum)?(this.failedValueBecauseOfMinimum=t,this._value=this.minimum.clone()):t.isGreaterThan(this.maximum)?(this.failedValueBecauseOfMaximum=t,this._value=this.maximum.clone()):this._value=t,this._isSet=!0),this._input&&(this._input.value=this.formatTime(),this.autosizeInput(),document.activeElement==this._input&&this.selectTimePart())}get previousValue(){if(null!=this._previousValue)return this._previousValue.replace(/^\+/,"")}get vibrate(){return this._vibrate}set vibrate(t){null!=t&&"vibrate"in navigator?"string"==typeof t&&(t=!t.match(/^false$/i)):t=!1,this._vibrate=t}get input(){return this._input}get scrollContainer(){return this._scrollContainer||document.documentElement}attributeChangedCallback(t,e,i){switch(t){case"animationduration":this.animationDuration=i;break;case"autosize":this.autosize=i;break;case"canceltext":break;case"disabled":this.disabled=i;break;case"format":this.format=i;break;case"maximum":this.maximum=i;break;case"minimum":this.minimum=i;break;case"precision":this.precision=i;break;case"required":this.required=i;break;case"separator":this.separator=i;break;case"useplussign":this.usePlusSign=i;break;case"value":this.value=i;break;case"vibrate":this.vibrate=i}}connectedCallback(){if(this._input=this.querySelector("input"),this._input){this._input.value&&(this.value=this._input.value),this._input.disabled&&(this._input.disabled=!1,this.disabled=!0),this._caretColorBefore=this._input.style.caretColor,this._inputObserver=new MutationObserver(()=>{this._scrollContainer&&(this._scrollContainer==document.documentElement?window:this._scrollContainer).removeEventListener("scroll",this.scrollListener),this._scrollContainer=this.getScrollContainer(this),(this._scrollContainer==document.documentElement?window:this._scrollContainer).addEventListener("scroll",this.scrollListener)}),this._inputObserver.observe(this._input,{attributes:!0});let t=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this._input),"value");const e=this;Object.defineProperty(this._input,"value",{get:function(){var e;return null===(e=null==t?void 0:t.get)||void 0===e?void 0:e.apply(this)},set:function(i){if(null==t?void 0:t.set)return t.set.apply(this,[i]),e.value!=i.replace(/^\+/,"")&&(e.value=i),i}}),Object.defineProperty(this._input,"disabled",{set:function(t){return e.disabled=t,e.disabled}})}else this._input=document.createElement("input"),this.appendChild(this._input);!this._value&&this.required&&(this._value=this.minimum.clone()),this._input.value=this.formatTime(),this._input.type="text",this._input.spellcheck=!1,this._input.autocomplete="off",this._input.readOnly=!0,this._input.style.caretColor="transparent",this._input.addEventListener("mousedown",this.inputMouseDownListener),this._input.addEventListener("focus",this.focusListener),this._input.addEventListener("blur",this.inputBlurListener),this._input.addEventListener("keydown",this.inputKeyDownListener),this._input.addEventListener("keyup",this.inputKeyUpListener),this._input.addEventListener("contextmenu",this.contextMenuListener),this.autosizeInput(),this._shadowRoot=document.createElement("div"),this._shadowRoot.className="clock-timepicker-shadow-root",this.appendChild(this._shadowRoot);const e=this._shadowRoot.attachShadow({mode:"open"}),i=document.createElement("style");i.innerHTML="\n      div.background-layer {\n        position: fixed;\n        z-index: 2147483646;\n        top: 0px;\n        left: 0px;\n        width: 100vw;\n        height: 100vh;\n        background: rgba(0, 0, 0, 0.6);\n        display: none;\n      }\n\n\t\t\tdiv.popup {\n\t\t\t\tposition: fixed;\n        z-index: 2147483647;\n        font-family: var(--clock-timepicker-font-family, Arial);\n\t\t\t\tcursor: var(--clock-timepicker-cursor, default);\n\t\t\t\tborder: var(--clock-timepicker-popup-border, none);\n\t\t\t\tborder-radius: var(--clock-timepicker-popup-border-radius, 5px);\n\t\t\t\tbox-shadow: var(--clock-timepicker-popup-shadow, rgba(0, 0, 0, 0.14) 0px 4px 20px 0px);\n\t\t\t\tbackground: var(--clock-timepicker-popup-background, #ffffff);\n\t\t\t\toverflow: hidden;\n\t\t\t\tuser-select: none;\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\n      div.header {\n        background: var(--clock-timepicker-header-background, var(--clock-timepicker-accent-color, #0797ff));\n        padding: 10px 0px;\n        text-align: center;\n      }\n\n      div.header > span {\n        font-size: var(--clock-timepicker-header-font-size, 40px);\n        line-height: var(--clock-timepicker-header-font-size, 40px);\n        color: var(--clock-timepicker-header-font-color, #ffffff);\n      }\n\n      div.header > span.active {\n        background: var(--clock-timepicker-header-selection-background, rgba(255, 255, 255, 0.6));\n      }\n\n      div.canvas-holder {\n        position: relative;\n        width: var(--clock-timepicker-popup-size, 200px);\n\t\t\t\theight: var(--clock-timepicker-popup-size, 200px);\n      }\n\n      div.footer {\n        display: flex;\n        gap: var(--clock-timepicker-button-gap, 30px);\n        justify-content: right;\n        padding: 10px 30px 15px 30px;\n      }\n\n      div.footer > button {\n        background: var(--clock-timepicker-button-background, none);\n        border: var(--clock-timepicker-button-border, none);\n        shadow: var(--clock-timepicker-button-shadow, none);\n        outline: var(--clock-timepicker-button-outline, none);\n        font-size: var(--clock-timepicker-button-font-size, 20px);\n        padding: var(--clock-timepicker-button-padding, none);\n        color: var(--clock-timepicker-button-color, var(--clock-timepicker-accent-color, #0797ff));\n        cursor: inherit;\n      }\n\n      div.footer > button.ok {\n        color: var(--clock-timepicker-button-ok-color, var(--clock-timepicker-button-color, var(--clock-timepicker-accent-color, #0797ff)));\n      }\n\n      div.footer > button.cancel {\n        color: var(--clock-timepicker-button-cancel-color, var(--clock-timepicker-button-color, var(--clock-timepicker-accent-color, #0797ff)));\n      }\n\t\t\t\n\t\t\tcanvas {\n        position: absolute;\n        left: 0px;\n        top: 0px;\n\t\t\t\tmargin: 20px;\n\t\t\t\twidth: 250px;\n\t\t\t\theight: 250px;\n        opacity: 0;\n\t\t\t}\n\n      @media (min-width: 600px) {\n        div.header { display: none; }\n        div.footer { display: none; }\n        canvas {\n          margin: 10px;\n          width: calc(var(--clock-timepicker-popup-size, 200px) - 2 * 10px);\n\t\t\t\t  height: calc(var(--clock-timepicker-popup-size, 200px) - 2 * 10px);\n        }\n      }\n\t\t",e.appendChild(i),this._backgroundLayer=document.createElement("div"),this._backgroundLayer.className="background-layer",this._backgroundLayer.addEventListener("mousedown",t=>t.preventDefault()),e.appendChild(this._backgroundLayer),this._popup=document.createElement("div"),this._popup.className="popup",this._popup.addEventListener("mousedown",t=>t.preventDefault()),this._popup.addEventListener("contextmenu",t=>t.preventDefault()),e.appendChild(this._popup),this._header=document.createElement("div"),this._header.className="header",this._popup.appendChild(this._header),this._canvasHolder=document.createElement("div"),this._canvasHolder.className="canvas-holder",this._popup.appendChild(this._canvasHolder),this._canvases=[new t(this,this._canvasHolder,TimePart.Hour),new t(this,this._canvasHolder,TimePart.Minute),new t(this,this._canvasHolder,TimePart.Second)],this._footer=document.createElement("div"),this._footer.className="footer";const s=document.createElement("button");s.className="cancel",s.innerHTML=this._cancelText,s.addEventListener("click",()=>this.cancel()),this._footer.appendChild(s);const a=document.createElement("button");a.className="ok",a.innerHTML=this._okText,a.addEventListener("click",()=>this.ok()),this._footer.appendChild(a),this._popup.appendChild(this._footer),window.addEventListener("orientationchange",this.orientationChangeListener),window.addEventListener("resize",this.resizeListener),this._scrollContainer=this.getScrollContainer(this),(this._scrollContainer==document.documentElement?window:this._scrollContainer).addEventListener("scroll",this.scrollListener)}disconnectedCallback(){var t;null===(t=this._scrollContainer==document.documentElement?window:this._scrollContainer)||void 0===t||t.removeEventListener("scroll",this.scrollListener),window.removeEventListener("orientationchange",this.orientationChangeListener),window.removeEventListener("resize",this.resizeListener),this._input&&(this._input.removeEventListener("mousedown",this.inputMouseDownListener),this._input.removeEventListener("focus",this.focusListener),this._input.removeEventListener("blur",this.inputBlurListener),this._input.removeEventListener("keydown",this.inputKeyDownListener),this._input.removeEventListener("keyup",this.inputKeyUpListener),this._input.removeEventListener("contextmenu",this.contextMenuListener),null!=this._caretColorBefore&&(this._input.style.caretColor=this._caretColorBefore)),this._inputObserver&&this._inputObserver.disconnect()}setTime(t){!this._input||null!=this._value&&t.equals(this._value)||(t.isLessThan(this._minimum)?this._value=this._minimum.clone():t.isGreaterThan(this._maximum)?this._value=this._maximum.clone():this._value=t,this._isSet=!0,this._input.value=this.formatTime(),this.autosizeInput(),this.vibrate&&navigator.vibrate(10),this.selectTimePart(),this.fireEvent("input"))}negateTime(){this._input&&this._value&&this.setTime(new Time(0,0,this._value.totalSeconds,!this._value.isNegative))}setTimePart(t,e){if(this._input)if(e<0)console.error("[clock-timepicker] setTimePart only accepts positive numbers! Use negateTime() to switch between positive and negative time...");else switch(t){case TimePart.Hour:null==this._value?this.setTime(new Time(e,0,0,this._maximum.isLessThan(Time.Zero))):this.setTime(new Time(e,this._value.minute,this._value.second,this._value.isNegative));break;case TimePart.Minute:if(e<0||e>=60)return void console.error("[clock-timepicker] setTimePart only accepts minutes between 0 and 59, but encountered: "+e);null==this._value?this.setTime(new Time(0,e,0,this._maximum.isLessThan(Time.Zero))):this.setTime(new Time(this._value.hour,e,this._value.second,this._value.isNegative));break;case TimePart.Second:if(e<0||e>=60)return void console.error("[clock-timepicker] setTimePart only accepts seconds between 0 and 59, but encountered: "+e);null==this._value?this.setTime(new Time(0,0,e,this._maximum.isLessThan(Time.Zero))):this.setTime(new Time(this._value.hour,this._value.minute,e,this._value.isNegative))}}selectTimePart(t=void 0){var e;if(!this._input||!this._header)return;null==t&&(t=this._activeTimePart);const i=this._canvases.find(e=>e.timePart==t);if(!i)return void this._input.blur();if(this._activeTimePart)this._activeTimePart!=t&&(this._enteredDigits=void 0,null===(e=this._canvases.find(t=>t.timePart==this._activeTimePart))||void 0===e||e.element.animate([{offset:0,opacity:1,transform:"scale(1)",zIndex:1},{offset:1,opacity:0,transform:"scale(0.7)",zIndex:0}],{duration:this.animationDuration,fill:"forwards"}),this._activeTimePart=t,i.element.animate([{offset:0,opacity:0,transform:"scale(0.7)",zIndex:0},{offset:1,opacity:1,transform:"scale(1)",zIndex:1}],{duration:this.animationDuration,fill:"forwards"}));else{this._activeTimePart=t;for(let t of this._canvases.filter(t=>t.timePart!=i.timePart))t.element.style.opacity="0",t.element.style.transform="scale(0.7)",t.element.style.zIndex="0";i.element.style.opacity="1",i.element.style.transform="scale(1)",i.element.style.zIndex="1"}i.refresh(),this._input.focus();const s=this.formatTime(TimePart.Hour).length,a=this.formatTime(TimePart.Minute).length,n=this.formatTime(TimePart.Second).length;switch(t){case TimePart.Hour:this._input.setSelectionRange(0,s);break;case TimePart.Minute:this._input.setSelectionRange(s+(s?1:0),s+(s?1:0)+a);break;case TimePart.Second:this._input.setSelectionRange(s+(s?1:0)+a+(a?1:0),s+(s?1:0)+a+(a?1:0)+n)}this._header.innerHTML="";const r=this.getAvailableTimeParts();for(let e=0;e<r.length;e++){if(e){const t=document.createElement("span");t.innerHTML=this.separator,this._header.appendChild(t)}const i=document.createElement("span");i.addEventListener("click",()=>this.selectTimePart(r[e])),r[e]==t&&(i.className="active"),i.innerHTML=this.formatTime(r[e]),this._header.appendChild(i)}}selectPreviousTimePart(){const t=this.getAvailableTimeParts(),e=t.findIndex(t=>t==this._activeTimePart);e>0&&this.selectTimePart(t[e-1])}selectNextTimePart(t=!0){var e;const i=this.getAvailableTimeParts(),s=i.findIndex(t=>t==this._activeTimePart);s<i.length-1?this.selectTimePart(i[s+1]):t&&(null===(e=this._input)||void 0===e||e.blur())}getScrollContainer(t){return t&&t!=document.documentElement&&t!=document.body?t.scrollHeight>t.clientHeight&&window.getComputedStyle(t).overflowY.match(/^auto|scroll$/)?t:this.getScrollContainer(t.parentElement):document.documentElement}ok(){this._input&&(this._input.blur(),this.vibrate&&navigator.vibrate(10))}cancel(){this._input&&(null!=this._previousValue&&(this._value=Time.parse(this._previousValue,this._format)),this._input.blur(),this.vibrate&&navigator.vibrate(10))}getAvailableTimeParts(t=!0){const e=[],i=this._precision.totalSeconds;for(let s of this.format.toString().split(":"))s.match(/h/i)&&e.push(TimePart.Hour),s.match(/m/)&&(!t||i<3600)&&e.push(TimePart.Minute),s.match(/s/)&&(!t||i<60)&&e.push(TimePart.Second);return e}fireEvent(t){if(!this._input)return;const e=new Event(t);this.dispatchEvent(e),"change"!=t&&"input"!=t||this._input.dispatchEvent(e)}showPopup(){if(!this._popup||!this._input||"1"==this._popup.style.opacity)return;this.value=this._input.value,this._value||(this._value=this.minimum.clone(),this._input.value=this.formatTime(),this.autosizeInput());const t=this._popup.querySelector("button.ok");t&&(t.innerHTML=this._okText);const e=this._popup.querySelector("button.cancel");e&&(e.innerHTML=this._cancelText),this._popup.style.pointerEvents="all",this.positionPopup(),this._popup.style.opacity="1",this._previousValue=this.formatTime()}hidePopup(){this._backgroundLayer&&this._popup&&this._input&&"0"!=this._popup.style.opacity&&(null!=this._value&&null!=this._precision&&(this._value=new Time(0,0,Math.round(this._value.totalSeconds/this._precision.totalSeconds)*this._precision.totalSeconds,this._value.isNegative),this._input.value=this.formatTime()),this._popup.style.opacity="0",this._popup.style.pointerEvents="none",this.required||this._isSet||(this._value=void 0,this._input.value=this.formatTime(),this.autosizeInput()),this._backgroundLayer.style.display="none",this._activeTimePart=void 0,this._enteredDigits=void 0,this._canvases.forEach(t=>t.element.getAnimations().forEach(t=>t.cancel())),this._input.value!=this._previousValue&&this.fireEvent("change"))}positionPopup(){var t;if(!(this._backgroundLayer&&this._input&&this._popup&&this._canvasHolder))return;let e,i;if(window.innerWidth<600?(e=window.innerWidth-80>300?"300px":window.innerWidth-80+"px",i=20):(e=window.getComputedStyle(this).getPropertyValue("--clock-timepicker-popup-size"),e||(e="200px"),i=10),this._canvasHolder.style.width=e,this._canvasHolder.style.height=e,this._popup.querySelectorAll("canvas").forEach(t=>{t.style.width="calc("+e+" - 2 * "+i+"px)",t.style.height="calc("+e+" - 2 * "+i+"px)";const s=window.devicePixelRatio||1;t.width=t.offsetWidth*s,t.height=t.offsetHeight*s;const a=t.getContext("2d");null==a||a.scale(s,s)}),null===(t=this._canvases.find(t=>t.timePart==this._activeTimePart))||void 0===t||t.refresh(),window.innerWidth<600)"all"==this._popup.style.pointerEvents&&(this._backgroundLayer.style.display="block"),this._popup.style.left=(window.innerWidth-this._popup.offsetWidth)/2+"px",this._popup.style.top=(window.innerHeight-this._popup.offsetHeight)/2+"px";else{this._backgroundLayer.style.display="none";const t=this._input.getBoundingClientRect(),e=window.getComputedStyle(this._input,"focus");if(t.top+this._input.offsetHeight+this._popup.offsetHeight+10>window.innerHeight?this._popup.style.top=t.top-this._popup.offsetHeight-parseInt(e.borderTop)+"px":this._popup.style.top=t.top+this._input.offsetHeight+parseInt(e.borderBottomWidth)+"px",this._input.offsetWidth<this._popup.offsetWidth){let e=t.left+this._input.offsetWidth/2-this._popup.offsetWidth/2;e+this._popup.offsetWidth+20>window.innerWidth&&(e=window.innerWidth-this._popup.offsetWidth-20),e<10&&(e=10),this._popup.style.left=e+"px"}else this._popup.style.left=t.left+"px"}}autosizeInput(){if(!this._input||!this.autosize)return;const t=window.getComputedStyle(this._input,"focus");this._input.style.width=this.getInputTextWidth()+parseInt(t.borderLeftWidth)+parseInt(t.paddingLeft)+parseInt(t.borderRightWidth)+parseInt(t.paddingRight)+"px"}formatTime(t=void 0,e=void 0){if(e||(e=this._value),!e)return"";let i=this.format;if(t){const e=i.toString().split(":");let s;if(t==TimePart.Hour?s=e.find(t=>t.match(/h/i)):t==TimePart.Minute?s=e.find(t=>t.match(/m/)):t==TimePart.Second&&(s=e.find(t=>t.match(/s/))),!s)return"";i=TimeFormat[s]}let s,a=e.hour,n=!1;switch(i.toString().match(/h/)&&(0==a?a=12:12==a?n=!0:a>12&&(a-=12,n=!0)),i){case"HH:mm":s=a.toString().padStart(2,"0")+this.separator+e.minute.toString().padStart(2,"0");break;case"H:mm":s=a.toString()+this.separator+e.minute.toString().padStart(2,"0");break;case"hh:mm":s=a.toString().padStart(2,"0")+this.separator+e.minute.toString().padStart(2,"0")+(t?"":" "+(n?"pm":"am"));break;case"h:mm":s=a.toString()+this.separator+e.minute.toString().padStart(2,"0")+(t?"":" "+(n?"pm":"am"));break;case"HH:mm:ss":s=a.toString().padStart(2,"0")+this.separator+e.minute.toString().padStart(2,"0")+this.separator+e.second.toString().padStart(2,"0");break;case"hh:mm:ss":s=a.toString().padStart(2,"0")+this.separator+e.minute.toString().padStart(2,"0")+this.separator+e.second.toString().padStart(2,"0")+(t?"":" "+(n?"pm":"am"));break;case"H:mm:ss":s=a.toString()+this.separator+e.minute.toString().padStart(2,"0")+this.separator+e.second.toString().padStart(2,"0");break;case"h:mm:ss":s=a.toString()+this.separator+e.minute.toString().padStart(2,"0")+this.separator+e.second.toString().padStart(2,"0")+(t?"":" "+(n?"pm":"am"));break;case"mm:ss":s=e.minute.toString().padStart(2,"0")+this.separator+e.second.toString().padStart(2,"0");break;case"m:ss":s=e.minute.toString()+this.separator+e.second.toString().padStart(2,"0");break;case"HH":s=a.toString().padStart(2,"0");break;case"H":s=a.toString();break;case"hh":s=a.toString().padStart(2,"0")+(t?"":" "+(n?"pm":"am"));break;case"h":s=a.toString()+(t?"":" "+(n?"pm":"am"));break;case"mm":s=e.minute.toString().padStart(2,"0");break;case"m":s=e.minute.toString();break;case"ss":s=e.second.toString().padStart(2,"0");break;case"s":s=e.second.toString();break;default:return""}return(this.usePlusSign&&!e.isNegative?"+":"")+(e.isNegative?"-":"")+s}getClickedTimePart(t){if(!this._input||!this._value)return"start";const e=window.getComputedStyle(this._input,"focus"),i=this._input.getBoundingClientRect();let s=this.getInputTextWidth();const a=t.pageX-i.left;let n=parseInt(e.borderLeft)+parseInt(e.paddingLeft);if("center"==e.textAlign&&(n=(this._input.offsetWidth-s)/2),e.textAlign.match(/^right|end$/)&&(n=this._input.offsetWidth-s),a<n)return"start";const r=this.getInputTextWidth(":");let o=!0;if(s=this.getInputTextWidth(TimePart.Hour),s){if(a>=n&&a<n+s+r/2)return TimePart.Hour;n+=s+r/2,o=!1}if(s=this.getInputTextWidth(TimePart.Minute),s){if(this._precision.totalSeconds<3600&&a>=n&&a<n+s+r/(o?2:1))return TimePart.Minute;n+=s+r,o=!1}return s=this.getInputTextWidth(TimePart.Second),s&&this._precision.totalSeconds<60&&a>=n&&a<n+s?TimePart.Second:this.format.toString().match(/h/)?"start":"end"}getInputTextWidth(t=void 0){if(!this._input)return 0;let e,i=0;if(null==t){const t=this.getAvailableTimeParts(!1);for(let e=0;e<t.length;e++)e&&(i+=this.getInputTextWidth(":")),i+=this.getInputTextWidth(t[e]);return this.format.match(/h/)&&(i+=this.getInputTextWidth("pm")),i}":"==t?e=this.separator:"am"==t||"pm"==t?e=" "+t:(e=this.formatTime(t),e||(e=this.formatTime(t,Time.Zero)));const s=window.getComputedStyle(this._input,"focus"),a=document.createElement("span");return a.style.position="fixed",a.style.top="-1000px",a.style.fontFamily=s.fontFamily,a.style.fontSize=s.fontSize,a.style.fontStyle=s.fontStyle,a.style.fontWeight=s.fontWeight,a.style.border=s.border,a.innerText=e,document.body.appendChild(a),i=a.offsetWidth,document.body.removeChild(a),i}}ClockTimepicker.observedAttributes=["animationduration","autosize","disabled","format","maximum","minimum","precision","required","separator","useplussign","value","vibrate"];class t{get timePart(){return this._timePart}get element(){return this._canvas}constructor(t,e,i){this._isMouseButtonPressed=!1,this._hoveredValue=void 0,this.downListener=()=>{this._clockTimepicker.input&&(this._isMouseButtonPressed=!0,null!=this._hoveredValue&&this._clockTimepicker.setTimePart(this.timePart,this._hoveredValue),this.refresh())},this.upListener=t=>{if(this._isMouseButtonPressed=!1,null!=this._hoveredValue)this._clockTimepicker.selectNextTimePart();else if(this._clockTimepicker.time){if(this._clockTimepicker.minimum.totalSeconds<0&&this._clockTimepicker.maximum.totalSeconds>0){const e=window.TouchEvent&&t instanceof TouchEvent?t.touches[0].pageX:t.pageX,i=window.TouchEvent&&t instanceof TouchEvent?t.touches[0].pageY:t.pageY,s=this._canvas.getBoundingClientRect(),a=e-s.left,n=i-s.top;a>=this._canvas.offsetWidth/2-this._canvas.offsetWidth/12&&a<=this._canvas.offsetWidth/2+this._canvas.offsetWidth/12&&n>=this._canvas.offsetWidth/2-this._canvas.offsetWidth/12&&n<=this._canvas.offsetWidth/2+this._canvas.offsetWidth/12&&(this._clockTimepicker.negateTime(),this.refresh())}}},this.moveListener=t=>{t.preventDefault();const e=window.TouchEvent&&t instanceof TouchEvent?t.touches[0].pageX:t.pageX,i=window.TouchEvent&&t instanceof TouchEvent?t.touches[0].pageY:t.pageY,s=this._canvas.getBoundingClientRect();let a=e-s.left-document.documentElement.scrollLeft,n=i-s.top-document.documentElement.scrollTop;const r=360*Math.atan((n-this._canvas.offsetWidth/2)/(a-this._canvas.offsetWidth/2))/(2*Math.PI)+90,o=Math.sqrt(Math.pow(Math.abs(a-this._canvas.offsetWidth/2),2)+Math.pow(Math.abs(n-this._canvas.offsetWidth/2),2));if(o>this._canvas.offsetWidth/2)this._hoveredValue=void 0;else if(o>=this._canvas.offsetWidth/2-2*this._canvas.offsetWidth/13){let t=Math.round(r/(this.timePart==TimePart.Hour?30:6));a<this._canvas.offsetWidth/2&&(t+=this.timePart==TimePart.Hour?6:30);let e=Math.ceil(this._clockTimepicker.precision.totalSeconds/(this.timePart==TimePart.Hour?3600:this.timePart==TimePart.Minute?60:1));t=e*Math.round(t/e),this.timePart==TimePart.Hour&&12==t&&(t=0),this.timePart!=TimePart.Hour&&60==t&&(t=0),this._hoveredValue=this.isDisabledValue(t)?void 0:t}else if(this.timePart==TimePart.Hour&&o>=this._canvas.offsetWidth/2-4*this._canvas.offsetWidth/13){let t=Math.round(r/30)+12,e=Math.ceil(this._clockTimepicker.precision.totalSeconds/3600);t=e*Math.round(t/e),a<this._canvas.offsetWidth/2&&(t+=6,24==t&&(t=12)),this._hoveredValue=this.isDisabledValue(t)?void 0:t}else this._hoveredValue=void 0;this._isMouseButtonPressed&&null!=this._hoveredValue&&this._clockTimepicker.setTimePart(this.timePart,this._hoveredValue),this.refresh()},this._clockTimepicker=t,this._timePart=i,this._canvas=document.createElement("canvas"),e.appendChild(this._canvas),this._canvas.setAttribute("width",this._canvas.offsetWidth.toString()),this._canvas.setAttribute("height",this._canvas.offsetHeight.toString()),this.refresh(),this._canvas.addEventListener("mousedown",this.downListener),this._canvas.addEventListener("touchstart",this.downListener,{passive:!1}),this._canvas.addEventListener("mouseup",this.upListener),this._canvas.addEventListener("touchend",this.upListener),this._canvas.addEventListener("mousemove",this.moveListener,{passive:!1}),this._canvas.addEventListener("touchmove",this.moveListener,{passive:!1}),this._canvas.addEventListener("mouseleave",()=>{this._hoveredValue=void 0,this.refresh()})}isDisabledValue(t){var e,i,s;let a;switch(this.timePart){case TimePart.Hour:a=((null===(e=this._clockTimepicker.time)||void 0===e?void 0:e.isNegative)?-1:1)*t*3600;break;case TimePart.Minute:a=((null===(i=this._clockTimepicker.time)||void 0===i?void 0:i.isNegative)?-1:1)*(3600*(this._clockTimepicker.time?this._clockTimepicker.time.hour:0)+60*t);break;case TimePart.Second:a=((null===(s=this._clockTimepicker.time)||void 0===s?void 0:s.isNegative)?-1:1)*(3600*(this._clockTimepicker.time?this._clockTimepicker.time.hour:0)+60*(this._clockTimepicker.time?this._clockTimepicker.time.minute:0)+t)}return!(a>=this._clockTimepicker.minimum.totalSeconds&&a<=this._clockTimepicker.maximum.totalSeconds)}refresh(){var t;const e=this._canvas.getContext("2d");if(!e)return;const i=window.getComputedStyle(this._clockTimepicker);let s=i.getPropertyValue("--clock-timepicker-accent-color");s||(s="#0797ff");let a=i.getPropertyValue("--clock-timepicker-font-family");a||(a="Arial");let n=i.getPropertyValue("--clock-timepicker-face-color");n||(n="#eeeeee");let r=i.getPropertyValue("--clock-timepicker-face-hover-color");r||(r="#dddddd");let o=i.getPropertyValue("--clock-timepicker-face-selection-color");o||(o=s);let h=i.getPropertyValue("--clock-timepicker-outer-numbers-color");h||(h="#000000");let c=i.getPropertyValue("--clock-timepicker-inner-numbers-color");c||(c="#888888");let l=i.getPropertyValue("--clock-timepicker-disabled-numbers-color");l||(l="#dddddd");let m=Math.ceil(this._clockTimepicker.precision.totalSeconds/(this.timePart==TimePart.Hour?3600:this.timePart==TimePart.Minute?60:1));e.clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetWidth),e.beginPath(),e.arc(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,0,2*Math.PI,!1),e.fillStyle=n,e.fill(),e.closePath();const u=this._canvas.offsetWidth/13,p=this._canvas.offsetWidth/15,d=this._canvas.offsetWidth/2-(u+2),v=d-2.2*p;if(null!=this._hoveredValue&&!this.isDisabledValue(this._hoveredValue)){const t=Math.PI/30*(this._hoveredValue*(this.timePart==TimePart.Hour?5:1)-15),i=this.timePart==TimePart.Hour&&this._hoveredValue>=12?v:d;e.beginPath(),e.fillStyle=r;const s=this._canvas.offsetWidth/2+Math.cos(t)*i,a=this._canvas.offsetWidth/2+Math.sin(t)*i;e.arc(s,a,this.timePart==TimePart.Hour&&this._hoveredValue>=12?p:u,0,2*Math.PI,!1),e.fill(),e.closePath()}if(this._clockTimepicker.time){const t=this._clockTimepicker.time.getTimePart(this.timePart);if(null!=t){const i=Math.PI/30*(t*(this.timePart==TimePart.Hour?5:1)-15),s=this.timePart==TimePart.Hour&&t>=12?v:d;e.beginPath(),e.fillStyle=o;const a=this._canvas.offsetWidth/2+Math.cos(i)*s,n=this._canvas.offsetWidth/2+Math.sin(i)*s;e.arc(a,n,this.timePart==TimePart.Hour&&t>=12?p:u,0,2*Math.PI,!1),e.fill(),e.closePath()}}for(let t=0;t<(this.timePart==TimePart.Hour?120:60);t++){const i=this.timePart==TimePart.Hour?t/5:t;if((!this._clockTimepicker.time||this._clockTimepicker.time.getTimePart(this.timePart)!=i)&&(t%5==0&&t%m==0)){let s;this.timePart==TimePart.Hour&&this._clockTimepicker.format.toString().match(/h/)&&i>=12?(s=(i-12).toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==s&&this.timePart==TimePart.Hour&&this._clockTimepicker.format.toString().match(/h/)&&(s="12\npm")):(s=i.toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==s&&this.timePart==TimePart.Hour&&this._clockTimepicker.format.toString().match(/h/)&&(s="12\nam"));const n=Math.PI/30*(t-15),r=t<60?d:v,o=t<60?u:p;e.fillStyle=this.isDisabledValue(i)?l:t<60?h:c;const m=this._canvas.offsetWidth/2+Math.cos(n)*r,_=this._canvas.offsetWidth/2+Math.sin(n)*r;this.writeText(e,s,m,_,a,o)}}if(this._clockTimepicker.time){const t=this._clockTimepicker.time.getTimePart(this.timePart);if(null!=t){const i=Math.PI/30*(t*(this.timePart==TimePart.Hour?5:1)-15),s=this.timePart==TimePart.Hour&&t>=12?v:d,a=this._canvas.offsetWidth/2+Math.cos(i)*s,n=this._canvas.offsetWidth/2+Math.sin(i)*s;e.beginPath(),e.moveTo(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2),e.lineTo(a,n),e.lineWidth=1,e.strokeStyle=o,e.stroke(),e.closePath()}}if(this._clockTimepicker.time){const t=this._clockTimepicker.time.getTimePart(this.timePart);if(null!=t){const i=Math.PI/30*(t*(this.timePart==TimePart.Hour?5:1)-15),s=this.timePart==TimePart.Hour&&t>=12?v:d,n=this._canvas.offsetWidth/2+Math.cos(i)*s,r=this._canvas.offsetWidth/2+Math.sin(i)*s,o=t<12||this.timePart!=TimePart.Hour?u:p;if(e.font=o+"px "+a,e.fillStyle="#fff",t%m==0){let i;this.timePart==TimePart.Hour&&this._clockTimepicker.format.toString().match(/h/)&&t>=12?(i=(t-12).toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==i&&this.timePart==TimePart.Hour&&this._clockTimepicker.format.toString().match(/h/)&&(i="12\npm")):(i=t.toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==i&&this.timePart==TimePart.Hour&&this._clockTimepicker.format.toString().match(/h/)&&(i="12\nam")),this.writeText(e,i,n,r,a,o)}else e.beginPath(),e.arc(n,r,2,0,2*Math.PI,!1),e.fill(),e.closePath()}}this._clockTimepicker.minimum.totalSeconds<0&&this._clockTimepicker.maximum.totalSeconds>0?(e.beginPath(),e.arc(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,this._canvas.offsetWidth/12,0,2*Math.PI,!1),e.fillStyle=o,e.fill(),e.closePath(),e.strokeStyle="#fff",e.beginPath(),e.moveTo(this._canvas.offsetWidth/2-this._canvas.offsetWidth/30,this._canvas.offsetWidth/2),e.lineTo(this._canvas.offsetWidth/2+this._canvas.offsetWidth/30,this._canvas.offsetWidth/2),e.lineWidth=2,e.stroke(),e.closePath(),(null===(t=this._clockTimepicker.time)||void 0===t?void 0:t.isNegative)||(e.beginPath(),e.moveTo(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2-this._canvas.offsetWidth/30),e.lineTo(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2+this._canvas.offsetWidth/30),e.lineWidth=2,e.stroke(),e.closePath())):(e.beginPath(),e.arc(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,this._canvas.offsetWidth/60,0,2*Math.PI,!1),e.fillStyle=o,e.fill(),e.closePath())}writeText(t,e,i,s,a,n){const r=e.split("\n");if(t.font=n+"px "+a,1==r.length)return void t.fillText(e,i-t.measureText(e).width/2,s+n/3);let o=s;for(let e of r)t.fillText(e,i-t.measureText(e).width/2,o),o+=9,t.font="9px "+a}}customElements.get("clock-timepicker")||customElements.define("clock-timepicker",ClockTimepicker);