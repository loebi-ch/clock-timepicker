export var TimeFormat;!function(TimeFormat){TimeFormat["HH:mm"]="HH:mm",TimeFormat["H:mm"]="H:mm",TimeFormat["hh:mm"]="hh:mm",TimeFormat["h:mm"]="h:mm",TimeFormat["HH:mm:ss"]="HH:mm:ss",TimeFormat["hh:mm:ss"]="hh:mm:ss",TimeFormat["H:mm:ss"]="H:mm:ss",TimeFormat["h:mm:ss"]="h:mm:ss",TimeFormat["mm:ss"]="mm:ss",TimeFormat["m:ss"]="m:ss",TimeFormat.HH="HH",TimeFormat.H="H",TimeFormat.hh="hh",TimeFormat.h="h",TimeFormat.mm="mm",TimeFormat.m="m",TimeFormat.ss="ss",TimeFormat.s="s"}(TimeFormat||(TimeFormat={}));export var TimePart;!function(TimePart){TimePart.Hour="Hour",TimePart.Minute="Minute",TimePart.Second="Second"}(TimePart||(TimePart={}));export class Time{static get Zero(){return new Time}static parse(timeAsString,timeFormat){if(!timeAsString)return;const match=timeAsString.toLowerCase().match(/^([+|-])?([0-9]+)([^0-9]+([0-9]+)([^0-9]+([0-9]+))?)?( *(am|pm))?$/i);if(match)switch(timeFormat){case"HH:mm":case"hh:mm":case"H:mm":case"h:mm":case"HH:mm:ss":case"hh:mm:ss":case"H:mm:ss":case"h:mm:ss":case"HH":case"hh":case"H":case"h":return new Time(Time.getHour(match[2],match[8],match[1]),Time.getMinute(match[4]),Time.getSecond(match[6]));case"mm:ss":case"m:ss":return match[6]&&new Time(Time.getHour(match[2],match[8],match[1]),Time.getMinute(match[4]),Time.getSecond(match[6])),new Time(0,this.getMinute(match[2]),this.getSecond(match[4]));case"mm":case"m":return match[4]?new Time(Time.getHour(match[2],match[8],match[1]),this.getMinute(match[4]),Time.getSecond(match[6])):new Time(0,this.getMinute(match[2]));case"ss":case"s":return match[6]?new Time(Time.getHour(match[2],match[8],match[1]),Time.getMinute(match[4]),Time.getSecond(match[6])):match[4]?new Time(0,this.getMinute(match[2]),Time.getSecond(match[4])):new Time(0,0,this.getSecond(match[2]))}else console.error("[clock-timepicker] Cannot parse time: "+timeAsString+". Invalid time format!")}static getHour(hourAsString,meridiem=void 0,sign){if(!hourAsString)return 0;let hour=parseInt(hourAsString);return meridiem&&("am"==meridiem&&12==hour&&(hour=0),"pm"==meridiem&&hour>=0&&hour<12&&(hour+=12)),("-"==sign?-1:1)*hour}static getMinute(minuteAsString){if(!minuteAsString)return 0;const minute=parseInt(minuteAsString);return minute>=60?(console.warn("[clock-timepicker] Minute cannot be greather than 59, but found: "+minuteAsString+"!"),0):minute}static getSecond(secondAsString){if(!secondAsString)return 0;const second=parseInt(secondAsString);return second>=60?(console.warn("[clock-timepicker] Second cannot be greather than 59, but found: "+secondAsString+"!"),0):second}constructor(hour=0,minute=0,second=0){this.hour=hour,this.minute=minute,this.second=second}getTimePart(timePart){return timePart==TimePart.Hour?Math.abs(this.hour):timePart==TimePart.Minute?this.minute:timePart==TimePart.Second?this.second:0}isZero(){return 0==this.hour&&0==this.minute&&0==this.second}equals(time){return this.hour==time.hour&&this.minute==time.minute&&this.second==time.second}isLessThan(time){return this.hour<time.hour||(this.hour==time.hour&&this.minute<time.minute||this.hour==time.hour&&this.minute==time.minute&&this.second<time.second)}isGreaterThan(time){return this.hour>time.hour||(this.hour==time.hour&&this.minute>time.minute||this.hour==time.hour&&this.minute==time.minute&&this.second>time.second)}}export class ClockTimepickerConfiguration{constructor(){this.animationDuration=300,this.autosize=!1,this.format=TimeFormat["HH:mm"],this.maximum="23:59",this.minimum="00:00",this.precision=1,this.required=!1,this.separator=":",this.usePlusSign=!1,this.vibrate=!0,this.onOpen=()=>{},this.onClose=()=>{},this.onTimePartChange=()=>{},this.onChange=()=>{},this.onAdjust=()=>{}}}export const DefaultClockTimepickerConfiguration=new ClockTimepickerConfiguration;export class ClockTimepicker extends HTMLElement{constructor(configuration=void 0){super(),this._input=void 0,this._scrollContainer=void 0,this._caretColorBefore=void 0,this._shadowRoot=void 0,this._backgroundLayer=void 0,this._popup=void 0,this._header=void 0,this._canvasHolder=void 0,this._footer=void 0,this._canvases=[],this._activeTimePart=void 0,this._time=void 0,this._isSet=!1,this._enteredNumber=void 0,this.orientationChangeListener=()=>this.positionPopup(),this.resizeListener=()=>this.positionPopup(),this.scrollListener=()=>this.positionPopup(),this.clickListener=$event=>{this._input&&this._popup&&($event.target==this._input||$event.target.closest(".clock-timepicker-shadow-root")==this._shadowRoot?this.showPopup():this.hidePopup())},this.inputMouseDownListener=$event=>{if(!this.input)return;$event.preventDefault(),$event.stopImmediatePropagation(),$event.stopPropagation();const clickedTimePart=this.getClickedTimePart($event),availableTimeParts=this.getAvailableTimeParts();"start"==clickedTimePart?this.selectTimePart(availableTimeParts[0]):"end"==clickedTimePart?this.selectTimePart(availableTimeParts[availableTimeParts.length-1]):this.selectTimePart(clickedTimePart)},this.inputBlurListener=()=>{setTimeout((()=>{var _a;this.hidePopup(),null===(_a=window.getSelection())||void 0===_a||_a.empty()}))},this.inputKeyDownListener=$event=>{if(this._input&&this._time&&this._activeTimePart&&"Tab"!=$event.key&&!$event.key.match(/^[0-9]$/))switch($event.preventDefault(),$event.key){case"Enter":this.ok();break;case"Escape":this.cancel();break;case"+":case"-":break;case":":case".":case this._configuration.separator:this.selectNextTimePart(!1);break;case"ArrowUp":switch(this._activeTimePart){case TimePart.Hour:this._time.hour<23&&this.setTimePart(this._activeTimePart,this._time.hour+1);break;case TimePart.Minute:this._time.minute<59&&this.setTimePart(this._activeTimePart,this._time.minute+1);break;case TimePart.Second:this._time.second<59&&this.setTimePart(this._activeTimePart,this._time.second+1)}break;case"ArrowDown":switch(this._activeTimePart){case TimePart.Hour:this._time.hour>0&&this.setTimePart(this._activeTimePart,this._time.hour-1);break;case TimePart.Minute:this._time.minute>0&&this.setTimePart(this._activeTimePart,this._time.minute-1);break;case TimePart.Second:this._time.second>0&&this.setTimePart(this._activeTimePart,this._time.second-1)}break;case"ArrowLeft":this.selectPreviousTimePart();break;case"ArrowRight":this.selectNextTimePart(!1);break;case"Backspace":case"Delete":if(!this._configuration.required){let minimumTime=Time.parse(this._configuration.minimum,this._configuration.format);if(minimumTime&&this._time.equals(minimumTime))return this._input.value="",this.autosizeInput(),this._isSet=!1,void this._input.blur()}0==this._time.getTimePart(this._activeTimePart)?this._configuration.required||this._activeTimePart!=this.getAvailableTimeParts()[0]?this.selectPreviousTimePart():(this._input.value="",this.autosizeInput(),this._isSet=!1,this._input.blur()):this.setTimePart(this._activeTimePart,0)}},this.inputKeyUpListener=$event=>{if($event.preventDefault(),!this._activeTimePart||!this._time||!$event.key.match(/^[0-9]$/))return;this._enteredNumber?this._enteredNumber=parseInt(this._enteredNumber.toString()+$event.key):this._enteredNumber=parseInt($event.key),this.setTimePart(this._activeTimePart,this._enteredNumber);let maxNumberLength=2;this._activeTimePart==TimePart.Hour&&(maxNumberLength=Time.parse(this._time.hour>=0?this._configuration.maximum:this._configuration.minimum,this._configuration.format).hour.toString().replace(/^[+|-]/,"").length),this._enteredNumber&&this._enteredNumber.toString().length!=maxNumberLength||(this._enteredNumber=void 0,this.selectNextTimePart())},this._configuration=configuration?Object.assign(Object.assign({},DefaultClockTimepickerConfiguration),configuration):Object.assign({},DefaultClockTimepickerConfiguration),"vibrate"in navigator||(this._configuration.vibrate=!1)}get configuration(){return this._configuration}get input(){return this._input}get time(){return this._time}get scrollContainer(){return this._scrollContainer||document.documentElement}attributeChangedCallback(name,oldValue,newValue){var _a,_b;switch(name){case"animationduration":if(!(null==newValue?void 0:newValue.match(/^[0-9]+$/)))return console.error("[clock-timepicker] Invalid animationDuration: "+newValue+"! For now, the animationDuration has been set back to: "+this._configuration.animationDuration),void this.setAttribute("animationDuration",this._configuration.animationDuration.toString());this._configuration.animationDuration=parseInt(newValue);break;case"autosize":this._configuration.autosize=null!=newValue;break;case"format":if(!TimeFormat[newValue])return console.error("[clock-timepicker] Invalid format specified: "+newValue+"! For now, the format has been set back to: "+this._configuration.format),void this.setAttribute("format",this._configuration.format);this._configuration.format=TimeFormat[newValue];break;case"maximum":this._configuration.maximum=newValue||"00:00";let maximumTime=Time.parse(this._configuration.maximum,this._configuration.format);maximumTime&&(null===(_a=this._time)||void 0===_a?void 0:_a.isGreaterThan(maximumTime))&&(this._time=maximumTime);break;case"minimum":newValue?this._configuration.minimum=newValue:this._configuration.maximum="23:59";let minimumTime=Time.parse(this._configuration.minimum,this._configuration.format);minimumTime&&(null===(_b=this._time)||void 0===_b?void 0:_b.isLessThan(minimumTime))&&(this._time=minimumTime);break;case"precision":if(!newValue.match(/^1|5|10|15|20|30|60$/))return console.error("[clock-timepicker] Invalid precision specified: "+newValue+"! Precision has to be 1, 5, 10, 15, 20, 30 or 60. For now, the precision has been set back to: "+this._configuration.precision),void this.setAttribute("precision",this._configuration.precision.toString());this._configuration.precision=parseInt(newValue);break;case"required":this._configuration.required=null!=newValue;break;case"separator":if(!newValue||newValue.match(/[0-9]+/))return console.error("[clock-timepicker] Invalid separator specified: "+(newValue||"(empty)")+'! The separator cannot be empty nor can it contain any decimals. For now, the separator has been set back to "'+this._configuration.separator+'".'),void this.setAttribute("separator",this._configuration.separator);this._configuration.separator=newValue;break;case"useplussign":this._configuration.usePlusSign=null!=newValue;break;case"value":newValue&&this.setTime(newValue);break;case"vibrate":this._configuration.vibrate=null!=newValue,this._configuration.vibrate&&!("vibrate"in navigator)&&(console.warn("[clock-timepicker] Vibration is not supported by this browser!"),this._configuration.vibrate=!1)}}connectedCallback(){this._input=this.querySelector("input"),this._input?(this.setTime(this._input.value),this._caretColorBefore=this._input.style.caretColor):(this._input=document.createElement("input"),this._input.type="text",this._input.spellcheck=!1,this.appendChild(this._input),!this._time&&this._configuration.required&&(this._time=this._configuration.minimum?Time.parse(this._configuration.minimum,this._configuration.format):Time.Zero),this._input.value=this.formatTime()),this._input.readOnly=!0,this._input.style.caretColor="transparent",this._input.addEventListener("mousedown",this.inputMouseDownListener),this._input.addEventListener("blur",this.inputBlurListener),this._input.addEventListener("keydown",this.inputKeyDownListener),this._input.addEventListener("keyup",this.inputKeyUpListener),this.autosizeInput(),this._shadowRoot=document.createElement("div"),this._shadowRoot.className="clock-timepicker-shadow-root",this.appendChild(this._shadowRoot);const shadowRoot=this._shadowRoot.attachShadow({mode:"open"}),style=document.createElement("style");style.innerHTML="\n      div.background-layer {\n        position: fixed;\n        z-index: 2147483646;\n        top: 0px;\n        left: 0px;\n        width: 100vw;\n        height: 100vh;\n        background: rgba(0, 0, 0, 0.6);\n        display: none;\n      }\n\n\t\t\tdiv.popup {\n\t\t\t\tposition: fixed;\n        z-index: 2147483647;\n        font-family: var(--clock-timepicker-font-family, Arial);\n\t\t\t\tcursor: var(--clock-timepicker-cursor, default);\n\t\t\t\tborder: var(--clock-timepicker-popup-border, none);\n\t\t\t\tborder-radius: var(--clock-timepicker-popup-border-radius, 5px);\n\t\t\t\tbox-shadow: var(--clock-timepicker-popup-shadow, rgba(0, 0, 0, 0.14) 0px 4px 20px 0px);\n\t\t\t\tbackground: var(--clock-timepicker-popup-background, #ffffff);\n\t\t\t\toverflow: hidden;\n\t\t\t\tuser-select: none;\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\n      div.header {\n        background: var(--clock-timepicker-header-background, var(--clock-timepicker-accent-color, #0797ff));\n        padding: 10px 0px;\n        text-align: center;\n      }\n\n      div.header > span {\n        font-size: var(--clock-timepicker-header-font-size, 40px);\n        line-height: var(--clock-timepicker-header-font-size, 40px);\n        color: var(--clock-timepicker-header-font-color, #ffffff);\n      }\n\n      div.header > span.active {\n        background: var(--clock-timepicker-header-selection-background, rgba(255, 255, 255, 0.6));\n      }\n\n      div.canvas-holder {\n        position: relative;\n        width: var(--clock-timepicker-popup-size, 200px);\n\t\t\t\theight: var(--clock-timepicker-popup-size, 200px);\n      }\n\n      div.footer {\n        display: flex;\n        gap: var(--clock-timepicker-button-gap, 30px);\n        justify-content: right;\n        padding: 10px 30px 15px 30px;\n      }\n\n      div.footer > button {\n        background: var(--clock-timepicker-button-background, none);\n        border: var(--clock-timepicker-button-border, none);\n        shadow: var(--clock-timepicker-button-shadow, none);\n        outline: var(--clock-timepicker-button-outline, none);\n        font-size: var(--clock-timepicker-button-font-size, 20px);\n        padding: var(--clock-timepicker-button-padding, none);\n        color: var(--clock-timepicker-button-color, var(--clock-timepicker-accent-color, #0797ff));\n        cursor: inherit;\n      }\n\n      div.footer > button.ok {\n        color: var(--clock-timepicker-button-ok-color, var(--clock-timepicker-button-color, var(--clock-timepicker-accent-color, #0797ff)));\n      }\n\n      div.footer > button.cancel {\n        color: var(--clock-timepicker-button-cancel-color, var(--clock-timepicker-button-color, var(--clock-timepicker-accent-color, #0797ff)));\n      }\n\t\t\t\n\t\t\tcanvas {\n        position: absolute;\n        left: 0px;\n        top: 0px;\n\t\t\t\tmargin: 20px;\n\t\t\t\twidth: 250px;\n\t\t\t\theight: 250px;\n        opacity: 0;\n\t\t\t}\n\n      @media (min-width: 600px) {\n        div.header { display: none; }\n        div.footer { display: none; }\n        canvas {\n          margin: 10px;\n          width: calc(var(--clock-timepicker-popup-size, 200px) - 2 * 10px);\n\t\t\t\t  height: calc(var(--clock-timepicker-popup-size, 200px) - 2 * 10px);\n        }\n      }\n\t\t",shadowRoot.appendChild(style),this._backgroundLayer=document.createElement("div"),this._backgroundLayer.className="background-layer",this._backgroundLayer.addEventListener("mousedown",($event=>$event.preventDefault())),shadowRoot.appendChild(this._backgroundLayer),this._popup=document.createElement("div"),this._popup.className="popup",this._popup.addEventListener("mousedown",($event=>$event.preventDefault())),this._popup.addEventListener("contextmenu",($event=>$event.preventDefault())),shadowRoot.appendChild(this._popup),this._header=document.createElement("div"),this._header.className="header",this._popup.appendChild(this._header),this._canvasHolder=document.createElement("div"),this._canvasHolder.className="canvas-holder",this._popup.appendChild(this._canvasHolder),this._canvases=[new ClockCanvas(this,this._canvasHolder,TimePart.Hour),new ClockCanvas(this,this._canvasHolder,TimePart.Minute),new ClockCanvas(this,this._canvasHolder,TimePart.Second)];const computedStyle=window.getComputedStyle(this);let cancelText=computedStyle.getPropertyValue("--clock-timepicker-button-cancel");cancelText||(cancelText="Cancel");let okText=computedStyle.getPropertyValue("--clock-timepicker-button-ok");okText||(okText="OK"),this._footer=document.createElement("div"),this._footer.className="footer";const cancelButton=document.createElement("button");cancelButton.className="cancel",cancelButton.innerHTML=cancelText,cancelButton.addEventListener("click",(()=>this.cancel())),this._footer.appendChild(cancelButton);const okButton=document.createElement("button");okButton.className="ok",okButton.innerHTML=okText,okButton.addEventListener("click",(()=>this.ok())),this._footer.appendChild(okButton),this._popup.appendChild(this._footer),window.addEventListener("click",this.clickListener),window.addEventListener("orientationchange",this.orientationChangeListener),window.addEventListener("resize",this.resizeListener),this._scrollContainer=this.getScrollContainer(this),(this._scrollContainer==document.documentElement?window:this._scrollContainer).addEventListener("scroll",this.scrollListener)}disconnectedCallback(){var _a;null===(_a=this._scrollContainer==document.documentElement?window:this._scrollContainer)||void 0===_a||_a.removeEventListener("scroll",this.scrollListener),window.removeEventListener("click",this.clickListener),window.removeEventListener("orientationchange",this.orientationChangeListener),window.removeEventListener("resize",this.resizeListener),this._input&&(this._input.removeEventListener("mousedown",this.inputMouseDownListener),this._input.removeEventListener("blur",this.inputBlurListener),this._input.removeEventListener("keydown",this.inputKeyDownListener),this._input.removeEventListener("keyup",this.inputKeyUpListener),null!=this._caretColorBefore&&(this._input.style.caretColor=this._caretColorBefore))}setTime(timeAsString){let time=Time.parse(timeAsString,this._configuration.format);if(null==time)this._time=this._configuration.required?this._configuration.minimum?Time.parse(this._configuration.minimum,this._configuration.format):Time.Zero:void 0;else{let minimumTime=Time.parse(this._configuration.minimum,this._configuration.format),maximumTime=Time.parse(this._configuration.maximum,this._configuration.format);minimumTime&&time.isLessThan(minimumTime)?this._time=minimumTime:maximumTime&&time.isGreaterThan(maximumTime)?this._time=maximumTime:this._time=time,this._isSet=!0}this._input&&(this._input.value=this.formatTime(),this.autosizeInput())}setTimePart(timePart,value,timePartToSelect=void 0){if(!this._input)return;let time;if(this._isSet=!0,timePart==TimePart.Hour)if(this._time){if(this._time.hour==value)return;time=new Time(value,this._time.minute,this._time.second)}else time=new Time(value,0);else if(timePart==TimePart.Minute){if(value<0||value>=60)return;if(this._time){if(this._time.minute==value)return;time=new Time(this._time.hour,value,this._time.second)}else time=new Time(0,value)}else if(timePart==TimePart.Second){if(value<0||value>=60)return;if(this._time){if(this._time.second==value)return;time=new Time(this._time.hour,this._time.minute,value)}else time=new Time(0,0,value)}if(null==time)return;let minimumTime=Time.parse(this._configuration.minimum,this._configuration.format),maximumTime=Time.parse(this._configuration.maximum,this._configuration.format);minimumTime&&time.isLessThan(minimumTime)?(this._time=minimumTime,this._enteredNumber=void 0):maximumTime&&time.isGreaterThan(maximumTime)?(this._time=maximumTime,this._enteredNumber=void 0):this._time=time,this._input.value=this.formatTime(),this.autosizeInput(),this._configuration.vibrate&&navigator.vibrate(10),this.selectTimePart(null!=timePartToSelect?timePartToSelect:timePart)}selectTimePart(timePart){var _a;if(!this._input||!this._header)return;const canvas=this._canvases.find((t=>t.timePart==timePart));this._activeTimePart?this._activeTimePart!=timePart&&(this._enteredNumber=void 0,null===(_a=this._canvases.find((t=>t.timePart==this._activeTimePart)))||void 0===_a||_a.element.animate({opacity:0,transform:"scale(0.7)",zIndex:0},{duration:this._configuration.animationDuration,fill:"forwards"}),this._activeTimePart=timePart,canvas.element.animate({opacity:1,transform:"scale(1)",zIndex:1},{duration:this._configuration.animationDuration,fill:"forwards"})):(this._activeTimePart=timePart,canvas.element.style.opacity="1",canvas.element.style.zIndex="1"),canvas.refresh(),this._input.focus();const hourLength=this.formatTime(TimePart.Hour).length,minuteLength=this.formatTime(TimePart.Minute).length,secondLength=this.formatTime(TimePart.Second).length;switch(timePart){case TimePart.Hour:this._input.setSelectionRange(0,hourLength);break;case TimePart.Minute:this._input.setSelectionRange(hourLength+(hourLength?1:0),hourLength+(hourLength?1:0)+minuteLength);break;case TimePart.Second:this._input.setSelectionRange(hourLength+(hourLength?1:0)+minuteLength+(minuteLength?1:0),hourLength+(hourLength?1:0)+minuteLength+(minuteLength?1:0)+secondLength)}this._header.innerHTML="";const availableTimeParts=this.getAvailableTimeParts();for(let i=0;i<availableTimeParts.length;i++){if(i){const separatorSpan=document.createElement("span");separatorSpan.innerHTML=this._configuration.separator,this._header.appendChild(separatorSpan)}const span=document.createElement("span");span.addEventListener("click",(()=>this.selectTimePart(availableTimeParts[i]))),availableTimeParts[i]==timePart&&(span.className="active"),span.innerHTML=this.formatTime(availableTimeParts[i]),this._header.appendChild(span)}}selectPreviousTimePart(){const timeParts=this.getAvailableTimeParts(),currentIndex=timeParts.findIndex((t=>t==this._activeTimePart));currentIndex>0&&this.selectTimePart(timeParts[currentIndex-1])}selectNextTimePart(closeAfterLastTimePart=!0){var _a;const timeParts=this.getAvailableTimeParts(),currentIndex=timeParts.findIndex((t=>t==this._activeTimePart));currentIndex<timeParts.length-1?this.selectTimePart(timeParts[currentIndex+1]):closeAfterLastTimePart&&(null===(_a=this._input)||void 0===_a||_a.blur())}getScrollContainer(element){return element&&element!=document.documentElement&&element!=document.body?element.scrollHeight>element.clientHeight?element:this.getScrollContainer(element.parentElement):document.documentElement}ok(){this._input&&(this._input.blur(),this._configuration.vibrate&&navigator.vibrate(10))}cancel(){this._input&&this._input.blur()}getAvailableTimeParts(){const timeParts=[];for(let part of this._configuration.format.toString().split(":"))part.match(/h/i)&&timeParts.push(TimePart.Hour),part.match(/m/)&&timeParts.push(TimePart.Minute),part.match(/s/)&&timeParts.push(TimePart.Second);return timeParts}showPopup(){this._popup&&this._input&&"1"!=this._popup.style.opacity&&(this._time||(this._time=this._configuration.minimum?Time.parse(this._configuration.minimum,this._configuration.format):Time.Zero,this._input.value=this.formatTime(),this.autosizeInput(),this._activeTimePart&&this.selectTimePart(this._activeTimePart)),this._popup.style.pointerEvents="all",this.positionPopup(),this._popup.style.opacity="1",this.dataset.timeBefore=this._input.value)}hidePopup(){this._backgroundLayer&&this._popup&&this._input&&(this._popup.style.opacity="0",this._popup.style.pointerEvents="none",delete this.dataset.timeBefore,this._configuration.required||this._isSet||(this._time=void 0,this._input.value=this.formatTime(),this.autosizeInput()),this._backgroundLayer.style.display="none")}positionPopup(){var _a;if(!(this._backgroundLayer&&this._input&&this._popup&&this._canvasHolder))return;let size,faceMargin;if(window.innerWidth<600?(size=window.innerWidth-80>300?"300px":window.innerWidth-80+"px",faceMargin=20):(size=window.getComputedStyle(this).getPropertyValue("--clock-timepicker-popup-size"),size||(size="200px"),faceMargin=10),this._canvasHolder.style.width=size,this._canvasHolder.style.height=size,this._popup.querySelectorAll("canvas").forEach((canvas=>{canvas.style.width="calc("+size+" - 2 * "+faceMargin+"px)",canvas.style.height="calc("+size+" - 2 * "+faceMargin+"px)";const dpr=window.devicePixelRatio||1;canvas.width=canvas.offsetWidth*dpr,canvas.height=canvas.offsetHeight*dpr;const ctx=canvas.getContext("2d");null==ctx||ctx.scale(dpr,dpr)})),null===(_a=this._canvases.find((t=>t.timePart==this._activeTimePart)))||void 0===_a||_a.refresh(),window.innerWidth<600)"all"==this._popup.style.pointerEvents&&(this._backgroundLayer.style.display="block"),this._popup.style.left=(window.innerWidth-this._popup.offsetWidth)/2+"px",this._popup.style.top=(window.innerHeight-this._popup.offsetHeight)/2+"px";else{this._backgroundLayer.style.display="none";const inputPosition=this._input.getBoundingClientRect(),inputFocusStyle=window.getComputedStyle(this._input,"focus");inputPosition.top+this._input.offsetHeight+this._popup.offsetHeight+10>window.innerHeight?this._popup.style.top=inputPosition.top-this._popup.offsetHeight-parseInt(inputFocusStyle.borderTop)+"px":this._popup.style.top=inputPosition.top+this._input.offsetHeight+parseInt(inputFocusStyle.borderBottomWidth)+"px";let left=inputPosition.left+this._input.offsetWidth/2-this._popup.offsetWidth/2;left+this._popup.offsetWidth+20>window.innerWidth&&(left=window.innerWidth-this._popup.offsetWidth-20),left<10&&(left=10),this._popup.style.left=left+"px"}}autosizeInput(){if(!this._input||!this._configuration.autosize)return;const computedStyle=window.getComputedStyle(this._input,"focus");this._input.style.width=this.getInputTextWidth()+parseInt(computedStyle.borderLeftWidth)+parseInt(computedStyle.paddingLeft)+parseInt(computedStyle.borderRightWidth)+parseInt(computedStyle.paddingRight)+"px"}formatTime(timePart=void 0,time=void 0){if(time||(time=this._time),!time)return"";let format=this._configuration.format;if(timePart){const timeFormatSplits=format.toString().split(":");let usedFormat;if(timePart==TimePart.Hour?usedFormat=timeFormatSplits.find((t=>t.match(/h/i))):timePart==TimePart.Minute?usedFormat=timeFormatSplits.find((t=>t.match(/m/))):timePart==TimePart.Second&&(usedFormat=timeFormatSplits.find((t=>t.match(/s/)))),!usedFormat)return"";format=TimeFormat[usedFormat]}let formattedTime,hour=time.hour,isPM=!1;switch(format.toString().match(/h/)&&(0==hour?hour=12:12==hour?isPM=!0:hour>12&&(hour-=12,isPM=!0)),format){case"HH:mm":formattedTime=hour.toString().padStart(2,"0")+this._configuration.separator+time.minute.toString().padStart(2,"0");break;case"H:mm":formattedTime=hour.toString()+this._configuration.separator+time.minute.toString().padStart(2,"0");break;case"hh:mm":formattedTime=hour.toString().padStart(2,"0")+this._configuration.separator+time.minute.toString().padStart(2,"0")+(timePart?"":" "+(isPM?"pm":"am"));break;case"h:mm":formattedTime=hour.toString()+this._configuration.separator+time.minute.toString().padStart(2,"0")+(timePart?"":" "+(isPM?"pm":"am"));break;case"HH:mm:ss":formattedTime=hour.toString().padStart(2,"0")+this._configuration.separator+time.minute.toString().padStart(2,"0")+this._configuration.separator+time.second.toString().padStart(2,"0");break;case"hh:mm:ss":formattedTime=hour.toString().padStart(2,"0")+this._configuration.separator+time.minute.toString().padStart(2,"0")+this._configuration.separator+time.second.toString().padStart(2,"0")+(timePart?"":" "+(isPM?"pm":"am"));break;case"H:mm:ss":formattedTime=hour.toString()+this._configuration.separator+time.minute.toString().padStart(2,"0")+this._configuration.separator+time.second.toString().padStart(2,"0");break;case"h:mm:ss":formattedTime=hour.toString()+this._configuration.separator+time.minute.toString().padStart(2,"0")+this._configuration.separator+time.second.toString().padStart(2,"0")+(timePart?"":" "+(isPM?"pm":"am"));break;case"mm:ss":formattedTime=time.minute.toString().padStart(2,"0")+this._configuration.separator+time.second.toString().padStart(2,"0");break;case"m:ss":formattedTime=time.minute.toString()+this._configuration.separator+time.second.toString().padStart(2,"0");break;case"HH":formattedTime=hour.toString().padStart(2,"0");break;case"H":formattedTime=hour.toString();break;case"hh":formattedTime=hour.toString().padStart(2,"0")+(timePart?"":" "+(isPM?"pm":"am"));break;case"h":formattedTime=hour.toString()+(timePart?"":" "+(isPM?"pm":"am"));break;case"mm":formattedTime=time.minute.toString().padStart(2,"0");break;case"m":formattedTime=time.minute.toString();break;case"ss":formattedTime=time.second.toString().padStart(2,"0");break;case"s":formattedTime=time.second.toString();break;default:return""}return(this._configuration.usePlusSign&&hour>=0?"+":"")+formattedTime}getClickedTimePart($event){if(!this._input||!this._time)return"start";const computedStyle=window.getComputedStyle(this._input,"focus"),inputPosition=this._input.getBoundingClientRect();let textWidth=this.getInputTextWidth();const x=$event.pageX-inputPosition.left;let _x=parseInt(computedStyle.borderLeft)+parseInt(computedStyle.paddingLeft);if("center"==computedStyle.textAlign&&(_x=(this._input.offsetWidth-textWidth)/2),computedStyle.textAlign.match(/^right|end$/)&&(_x=this._input.offsetWidth-textWidth),x<_x)return"start";const separatorWidth=this.getInputTextWidth(":");let isFirstPart=!0;if(textWidth=this.getInputTextWidth(TimePart.Hour),textWidth){if(x>=_x&&x<_x+textWidth+separatorWidth/2)return TimePart.Hour;_x+=textWidth+separatorWidth/2,isFirstPart=!1}if(textWidth=this.getInputTextWidth(TimePart.Minute),textWidth){if(x>=_x&&x<_x+textWidth+separatorWidth/(isFirstPart?2:1))return TimePart.Minute;_x+=textWidth+separatorWidth,isFirstPart=!1}return textWidth=this.getInputTextWidth(TimePart.Second),textWidth&&x>=_x&&x<_x+textWidth?TimePart.Second:this._configuration.format.toString().match(/h/)?"start":"end"}getInputTextWidth(timePart=void 0){if(!this._input)return 0;let text,width=0;if(null==timePart){const availableTimeParts=this.getAvailableTimeParts();for(let i=0;i<availableTimeParts.length;i++)i&&(width+=this.getInputTextWidth(":")),width+=this.getInputTextWidth(availableTimeParts[i]);return this._configuration.format.match(/h/)&&(width+=this.getInputTextWidth("pm")),width}":"==timePart?text=this._configuration.separator:"am"==timePart||"pm"==timePart?text=" "+timePart:(text=this.formatTime(timePart),text||(text=this.formatTime(timePart,Time.Zero)));const computedStyle=window.getComputedStyle(this._input,"focus"),ghost=document.createElement("span");return ghost.style.position="fixed",ghost.style.top="-1000px",ghost.style.fontFamily=computedStyle.fontFamily,ghost.style.fontSize=computedStyle.fontSize,ghost.style.fontStyle=computedStyle.fontStyle,ghost.style.fontWeight=computedStyle.fontWeight,ghost.style.border=computedStyle.border,ghost.innerText=text,document.body.appendChild(ghost),width=ghost.offsetWidth,document.body.removeChild(ghost),width}}ClockTimepicker.observedAttributes=["animationduration","autosize","format","maximum","minimum","precision","required","separator","useplussign","value","vibrate"];class ClockCanvas{get timePart(){return this._timePart}get element(){return this._canvas}constructor(clockTimepicker,canvasHolder,timePart){this._isMouseButtonPressed=!1,this._hoveredValue=void 0,this.downListener=()=>{this._clockTimepicker.input&&(this._isMouseButtonPressed=!0,null!=this._hoveredValue&&this._clockTimepicker.setTimePart(this.timePart,this._hoveredValue),this.refresh())},this.upListener=$event=>{if(this._isMouseButtonPressed=!1,null!=this._hoveredValue)this._clockTimepicker.selectNextTimePart();else if(this._clockTimepicker.time){if(this._clockTimepicker.configuration.minimum.startsWith("-")||this._clockTimepicker.configuration.maximum.startsWith("-")){const pageX=$event instanceof TouchEvent?$event.touches[0].pageX:$event.pageX,pageY=$event instanceof TouchEvent?$event.touches[0].pageY:$event.pageY,canvasPosition=this._canvas.getBoundingClientRect(),x=pageX-canvasPosition.left-this._clockTimepicker.scrollContainer.scrollLeft,y=pageY-canvasPosition.top-this._clockTimepicker.scrollContainer.scrollTop;x>=this._canvas.offsetWidth/2-this._canvas.offsetWidth/12&&x<=this._canvas.offsetWidth/2+this._canvas.offsetWidth/12&&y>=this._canvas.offsetWidth/2-this._canvas.offsetWidth/12&&y<=this._canvas.offsetWidth/2+this._canvas.offsetWidth/12&&this._clockTimepicker.setTimePart(TimePart.Hour,-this._clockTimepicker.time.hour,this.timePart)}}},this.moveListener=$event=>{$event.preventDefault();const pageX=$event instanceof TouchEvent?$event.touches[0].pageX:$event.pageX,pageY=$event instanceof TouchEvent?$event.touches[0].pageY:$event.pageY,canvasPosition=this._canvas.getBoundingClientRect(),x=pageX-canvasPosition.left-this._clockTimepicker.scrollContainer.scrollLeft,y=pageY-canvasPosition.top-this._clockTimepicker.scrollContainer.scrollTop,selectorAngle=360*Math.atan((y-this._canvas.offsetWidth/2)/(x-this._canvas.offsetWidth/2))/(2*Math.PI)+90,selectorLength=Math.sqrt(Math.pow(Math.abs(x-this._canvas.offsetWidth/2),2)+Math.pow(Math.abs(y-this._canvas.offsetWidth/2),2));if(selectorLength>this._canvas.offsetWidth/2)this._hoveredValue=void 0;else if(selectorLength>=this._canvas.offsetWidth/2-2*this._canvas.offsetWidth/13){let value=Math.round(selectorAngle/(this.timePart==TimePart.Hour?30:6));x<this._canvas.offsetWidth/2&&(value+=this.timePart==TimePart.Hour?6:30),1!=this._clockTimepicker.configuration.precision&&this.timePart==TimePart.Minute&&(value=this._clockTimepicker.configuration.precision*Math.round(value/this._clockTimepicker.configuration.precision)),this.timePart==TimePart.Hour&&12==value&&(value=0),this.timePart!=TimePart.Hour&&60==value&&(value=0),this._hoveredValue=this.isDisabledValue(value)?void 0:value}else if(this.timePart==TimePart.Hour&&selectorLength>=this._canvas.offsetWidth/2-4*this._canvas.offsetWidth/13){let hour=Math.round(selectorAngle/30)+12;x<this._canvas.offsetWidth/2&&(hour+=6,24==hour&&(hour=12)),this._hoveredValue=this.isDisabledValue(hour)?void 0:hour}else this._hoveredValue=void 0;this._isMouseButtonPressed&&null!=this._hoveredValue&&this._clockTimepicker.setTimePart(this.timePart,this._hoveredValue),this.refresh()},this._clockTimepicker=clockTimepicker,this._timePart=timePart,this._canvas=document.createElement("canvas"),canvasHolder.appendChild(this._canvas),this._canvas.setAttribute("width",this._canvas.offsetWidth.toString()),this._canvas.setAttribute("height",this._canvas.offsetHeight.toString()),this.refresh(),this._canvas.addEventListener("mousedown",this.downListener),this._canvas.addEventListener("touchstart",this.downListener),this._canvas.addEventListener("mouseup",this.upListener),this._canvas.addEventListener("touchend",this.upListener),this._canvas.addEventListener("mousemove",this.moveListener),this._canvas.addEventListener("touchmove",this.moveListener),this._canvas.addEventListener("mouseleave",(()=>{this._hoveredValue=void 0,this.refresh()}))}isDisabledValue(value){var _a,_b,_c,_d,_e,_f;let minimumTime=Time.parse(this._clockTimepicker.configuration.minimum,this._clockTimepicker.configuration.format),maximumTime=Time.parse(this._clockTimepicker.configuration.maximum,this._clockTimepicker.configuration.format);return!(!minimumTime||!(this.timePart==TimePart.Hour&&value<minimumTime.hour||this.timePart==TimePart.Minute&&(null===(_a=this._clockTimepicker.time)||void 0===_a?void 0:_a.hour)==minimumTime.hour&&value<minimumTime.minute||this.timePart==TimePart.Second&&(null===(_b=this._clockTimepicker.time)||void 0===_b?void 0:_b.hour)==minimumTime.hour&&(null===(_c=this._clockTimepicker.time)||void 0===_c?void 0:_c.minute)==minimumTime.minute&&value<minimumTime.second))||!(!maximumTime||!(this.timePart==TimePart.Hour&&value>maximumTime.hour||this.timePart==TimePart.Minute&&(null===(_d=this._clockTimepicker.time)||void 0===_d?void 0:_d.hour)==maximumTime.hour&&value>maximumTime.minute||this.timePart==TimePart.Second&&(null===(_e=this._clockTimepicker.time)||void 0===_e?void 0:_e.hour)==maximumTime.hour&&(null===(_f=this._clockTimepicker.time)||void 0===_f?void 0:_f.minute)==maximumTime.minute&&value>maximumTime.second))}refresh(){const ctx=this._canvas.getContext("2d");if(!ctx)return;const computedStyle=window.getComputedStyle(this._clockTimepicker);let accentColor=computedStyle.getPropertyValue("--clock-timepicker-accent-color");accentColor||(accentColor="#0797ff");let font=computedStyle.getPropertyValue("--clock-timepicker-font-family");font||(font="Arial");let faceColor=computedStyle.getPropertyValue("--clock-timepicker-face-color");faceColor||(faceColor="#eeeeee");let faceHoverColor=computedStyle.getPropertyValue("--clock-timepicker-face-hover-color");faceHoverColor||(faceHoverColor="#dddddd");let faceSelectionColor=computedStyle.getPropertyValue("--clock-timepicker-face-selection-color");faceSelectionColor||(faceSelectionColor=accentColor);let outerNumbersColor=computedStyle.getPropertyValue("--clock-timepicker-outer-numbers-color");outerNumbersColor||(outerNumbersColor="#000000");let innerNumbersColor=computedStyle.getPropertyValue("--clock-timepicker-inner-numbers-color");innerNumbersColor||(innerNumbersColor="#888888");let disabledNumbersColor=computedStyle.getPropertyValue("--clock-timepicker-disabled-numbers-color");disabledNumbersColor||(disabledNumbersColor="#dddddd"),ctx.clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetWidth),ctx.beginPath(),ctx.arc(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,0,2*Math.PI,!1),ctx.fillStyle=faceColor,ctx.fill(),ctx.closePath();const clockOuterCircleFontSize=this._canvas.offsetWidth/13,clockInnerCircleFontSize=this._canvas.offsetWidth/15,clockOuterRadius=this._canvas.offsetWidth/2-(clockOuterCircleFontSize+2),clockInnerRadius=clockOuterRadius-2.2*clockInnerCircleFontSize;if(null!=this._hoveredValue&&!this.isDisabledValue(this._hoveredValue)){const angle=Math.PI/30*(this._hoveredValue*(this.timePart==TimePart.Hour?5:1)-15),radius=this.timePart==TimePart.Hour&&this._hoveredValue>=12?clockInnerRadius:clockOuterRadius;ctx.beginPath(),ctx.fillStyle=faceHoverColor;const x=this._canvas.offsetWidth/2+Math.cos(angle)*radius,y=this._canvas.offsetWidth/2+Math.sin(angle)*radius;ctx.arc(x,y,this.timePart==TimePart.Hour&&this._hoveredValue>=12?clockInnerCircleFontSize:clockOuterCircleFontSize,0,2*Math.PI,!1),ctx.fill(),ctx.closePath()}if(this._clockTimepicker.time){const value=this._clockTimepicker.time.getTimePart(this.timePart);if(null!=value){const angle=Math.PI/30*(value*(this.timePart==TimePart.Hour?5:1)-15),radius=this.timePart==TimePart.Hour&&value>=12?clockInnerRadius:clockOuterRadius;ctx.beginPath(),ctx.fillStyle=faceSelectionColor;const x=this._canvas.offsetWidth/2+Math.cos(angle)*radius,y=this._canvas.offsetWidth/2+Math.sin(angle)*radius;ctx.arc(x,y,this.timePart==TimePart.Hour&&value>=12?clockInnerCircleFontSize:clockOuterCircleFontSize,0,2*Math.PI,!1),ctx.fill(),ctx.closePath()}}for(let i=0;i<(this.timePart==TimePart.Hour?120:60);i++){const value=this.timePart==TimePart.Hour?i/5:i;if((!this._clockTimepicker.time||this._clockTimepicker.time.getTimePart(this.timePart)!=value)&&(i%5==0&&(this.timePart==TimePart.Hour||i%this._clockTimepicker.configuration.precision==0))){let s;this.timePart==TimePart.Hour&&this._clockTimepicker.configuration.format.toString().match(/h/)&&value>=12?(s=(value-12).toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==s&&this.timePart==TimePart.Hour&&this._clockTimepicker.configuration.format.toString().match(/h/)&&(s="12\npm")):(s=value.toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==s&&this.timePart==TimePart.Hour&&this._clockTimepicker.configuration.format.toString().match(/h/)&&(s="12\nam"));const angle=Math.PI/30*(i-15),radius=i<60?clockOuterRadius:clockInnerRadius,fontSize=i<60?clockOuterCircleFontSize:clockInnerCircleFontSize;ctx.fillStyle=this.isDisabledValue(value)?disabledNumbersColor:i<60?outerNumbersColor:innerNumbersColor;const x=this._canvas.offsetWidth/2+Math.cos(angle)*radius,y=this._canvas.offsetWidth/2+Math.sin(angle)*radius;this.writeText(ctx,s,x,y,font,fontSize)}}if(this._clockTimepicker.time){const value=this._clockTimepicker.time.getTimePart(this.timePart);if(null!=value){const angle=Math.PI/30*(value*(this.timePart==TimePart.Hour?5:1)-15),radius=this.timePart==TimePart.Hour&&value>=12?clockInnerRadius:clockOuterRadius,x=this._canvas.offsetWidth/2+Math.cos(angle)*radius,y=this._canvas.offsetWidth/2+Math.sin(angle)*radius;ctx.beginPath(),ctx.moveTo(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2),ctx.lineTo(x,y),ctx.lineWidth=1,ctx.strokeStyle=faceSelectionColor,ctx.stroke(),ctx.closePath()}}if(this._clockTimepicker.time){const value=this._clockTimepicker.time.getTimePart(this.timePart);if(null!=value){const angle=Math.PI/30*(value*(this.timePart==TimePart.Hour?5:1)-15),radius=this.timePart==TimePart.Hour&&value>=12?clockInnerRadius:clockOuterRadius,x=this._canvas.offsetWidth/2+Math.cos(angle)*radius,y=this._canvas.offsetWidth/2+Math.sin(angle)*radius,fontSize=value<12||this.timePart!=TimePart.Hour?clockOuterCircleFontSize:clockInnerCircleFontSize;if(ctx.font=fontSize+"px "+font,ctx.fillStyle="#fff",this.timePart==TimePart.Hour||value%5==0&&value%this._clockTimepicker.configuration.precision==0){let s;this.timePart==TimePart.Hour&&this._clockTimepicker.configuration.format.toString().match(/h/)&&value>=12?(s=(value-12).toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==s&&this.timePart==TimePart.Hour&&this._clockTimepicker.configuration.format.toString().match(/h/)&&(s="12\npm")):(s=value.toString().padStart(this.timePart==TimePart.Hour?1:2,"0"),"0"==s&&this.timePart==TimePart.Hour&&this._clockTimepicker.configuration.format.toString().match(/h/)&&(s="12\nam")),this.writeText(ctx,s,x,y,font,fontSize)}else ctx.beginPath(),ctx.arc(x,y,2,0,2*Math.PI,!1),ctx.fill(),ctx.closePath()}}this._clockTimepicker.configuration.minimum.startsWith("-")||this._clockTimepicker.configuration.maximum.startsWith("-")?(ctx.beginPath(),ctx.arc(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,this._canvas.offsetWidth/12,0,2*Math.PI,!1),ctx.fillStyle=faceSelectionColor,ctx.fill(),ctx.closePath(),ctx.strokeStyle="#fff",ctx.beginPath(),ctx.moveTo(this._canvas.offsetWidth/2-this._canvas.offsetWidth/30,this._canvas.offsetWidth/2),ctx.lineTo(this._canvas.offsetWidth/2+this._canvas.offsetWidth/30,this._canvas.offsetWidth/2),ctx.lineWidth=2,ctx.stroke(),ctx.closePath(),this._clockTimepicker.time&&this._clockTimepicker.time.hour>=0&&(ctx.beginPath(),ctx.moveTo(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2-this._canvas.offsetWidth/30),ctx.lineTo(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2+this._canvas.offsetWidth/30),ctx.lineWidth=2,ctx.stroke(),ctx.closePath())):(ctx.beginPath(),ctx.arc(this._canvas.offsetWidth/2,this._canvas.offsetWidth/2,this._canvas.offsetWidth/60,0,2*Math.PI,!1),ctx.fillStyle=faceSelectionColor,ctx.fill(),ctx.closePath())}writeText(ctx,text,x,y,font,fontSize){const splits=text.split("\n");if(ctx.font=fontSize+"px "+font,1==splits.length)return void ctx.fillText(text,x-ctx.measureText(text).width/2,y+fontSize/3);let _y=y;for(let split of splits)ctx.fillText(split,x-ctx.measureText(split).width/2,_y),_y+=9,ctx.font="9px "+font}}customElements.define("clock-timepicker",ClockTimepicker);